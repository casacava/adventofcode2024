type Direction = { dx: number; dy: number };

// these are the coordinate detlas for directions - up, right, down, left
const DIRECTIONS: Direction[] = [
  { dx: 0, dy: -1 },  // Up
  { dx: 1, dy: 0 },   // Right
  { dx: 0, dy: 1 },   // Down
  { dx: -1, dy: 0 },  // Left
];

// function to predict the guard's path
function predictGuardPath(map: string[]): number {
  const visited = new Set<string>()
  const rows = map.length
  const cols = map[0].length

  // Find initial guard position and direction
  let x = 0, y = 0, directionIndex = 0;

  outer: for (let i = 0; i < rows; i++) {
    for (let j = 0; j < cols; j++) {
      if (map[i][j] === '^') {
        x = j; y = i; directionIndex = 0
        break outer;
      }
    }
  }

  // helper fx to check if position is within bounds and NOT blocked
  const isValid = (nx: number, ny: number) =>
    nx >= 0 && ny >= 0 && nx < cols && ny < rows && map[ny][nx] !== '#'

  // guards movement
  while (true) {
    visited.add(`${x}, ${y}`)
    const { dx, dy } = DIRECTIONS[directionIndex]
    const nx = x + dx
    const ny = y + dy

    if (isValid(nx, ny)) {
      x = nx
      y = ny
    } else {
      directionIndex = (directionIndex + 1) % 4
    }

    // check if guard moves outside map
    if (nx < 0 || ny < 0 || nx >= cols || ny >= rows) break
  }
  return visited.size
}

const map = [
'................#...#..........................#.##..........#.......#..............................#........#..............#.....',
'...................#.............#....................#...........................................................................',
'....#....................................#....#................................................#..#...........#...................',
'....#.#..............#..........#...................#...................................#....................#........#......#....',
'...........................#...........#..#......#.......................................#.......................#......#.........',
'.....................................................................................................#.................#..........',
'...................................................#.............#..........#..............................#......................',
'................................#...........##....................................................................#....#..........',
'...........#.......#.......................................................................#............#.....................#...',
'.#........#.......#........................................#.#...............................#...#...........................#....',
'..#...............#................#....#............#................................................................#...........',
'........#..........#.........#....................................................................................#...............',
'............................................................................#.............................#...............#......#',
'......................#................................#.............#...#............#...........................................',
'................................#.............#.................................................................#..............#..',
'.........#.#..#...............................#....................................................#.#.......#..#........#........',
'.............................#.......#.....#......................................................#..#............................',
'..................#.............................................................................#..........#......................',
'.....................................#....##.................#......................................#....#........................',
'#.......................................................................................................................#.........',
'......#....#..#...........................#..#.....#........................................#..................................#..',
'.......#.....#...............#....#......#....#..........#.....................#....#..........#.....#..#......................##.',
'..................#..........#.....#........................................................#............##...................#...',
'........................#....#............#..................................#....#..#.......#...................................#',
'.....#............................#...............................#..#...................#.....#..#........#....#.#...............',
'......#...#..#......#..........................#........#....................#.......#...........#..........................#..#..',
'.....#.............................................................................................#......#......................#',
'...........................................#......................................................................................',
'.....#...........................#.#.#............................#..................#............................#.......#.......',
'........#.......................................................#...................#.......#.....................................',
'...............#..................................................#.................................................#.............',
'..##............................................................#..............................................................#..',
'.......#..................................#......................#.................................#...................#..........',
'......#.........#..............#....##........#....#................................#.....................................#......#',
'................#.....................................................................................#.............#.............',
'#..#..#......#.#.....#..#.................................................................................................#..#....',
'.....................#.....#................................................#.......#........#.................#........#.#...#...',
'..................................................................#....#..#...................#................................#..',
'........................#...........#.......................................................#..#..................................',
'.#.......#...................................................#..............#.......#...#.........................................',
'.......##...............#.............................#...........................#...............................................',
'....#............#....#...#........................#...........................#.#.....#..........................................',
'...........................#............................#..#..................#...........................#...#...................',
'...........#.#.............#..........#...........................................................................................',
'.............#..........#...............#...##.........................#..............#...#.............#..#......................',
'..................#.....#............#..#.........#...............................................................................',
'...........................................................#.....#..................#.......................#..#..................',
'....................................#....#.......##............#.............................#...............#...........#........',
'......#....................#..................#..........................................#...............................#.#......',
'......................#...........................................#.....#.................................................#....#..',
'.....................................#...............#....................................#.....#.............#......##...........',
'......................#...............................................................##.#..........#....#..................#.....',
'...........#.............#......................#....................#..................................#......#...........##.....',
'.....#.#...#......................................................................................................................',
'.........#.....................................#................#.............#....#......................#..........#............',
'......##.#.................#...............#..##.......................#...............#.......................................#..',
'....................#.........#.......#....#..................................#..........................#..............#.........',
'......................#....#..#..#................................#.......#.......................................................',
'.........................................##............................##..#..................#..................#...........#....',
'...................#..................................#................................................................#..........',
'.#.............#....................................................................................#.............................',
'......................................#.....#.............#..#............................................#...#............#......',
'.....................................#..................................#...#.......................##...................#........',
'...........................................................#...................................................#...........#......',
'.............................#.......#.......................................#.........................#.....................#...#',
'.....................#............................................................................................................',
'#....#.......................................#.........#........#...................................#.....#.........#........#....',
'.......................................................#......#................................##.#........#.........#..........#.',
'.........#........................##.....#.............................................................#.................#..#.....',
'....##....................................................................................................#...#...#...............',
'.......#.....#.......#.............#........#...............##.#......#...............#.................#..#.........#...#....#...',
'....................#.................................#........................................................................#..',
'#...............#....................................#.........#...............................#..#..........##...#...#......#....',
'............#........................#.....#...#.........#.........#..#......................................#....................',
'..........#.......#.#.....................#...........#...................#.##....................#..#...#........#..............#',
'.......................................#.......#........#.....#...........................................#.......#......#........',
'...............................#.........#..............#......................#..........................................#.#.....',
'............#........#.............................................#.....................................................##......#',
'......#.#............................................................................#......#.....#......#................#.......',
'.........#.............#................#.................#..###..........#.........................#.#....#......................',
]

console.log(predictGuardPath(map))